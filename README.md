# Avro Source Generator

Avro Source Generator is a .NET source generator that generates C# classes from Avro schemas. This project leverages the power of Roslyn to automatically generate strongly-typed classes based on Avro schema definitions, making it easier to work with Avro data in .NET applications.

## Features

- Generates C# classes from Avro schemas.
- Supports various Avro schema types including records, enums, arrays, maps, and more.
- Integrates with .NET build process using source generators.
- Supports nullable reference types, file-scoped namespaces, init-only properties, requires properties, and other modern C# features.

## Getting Started

### Prerequisites

- .NET SDK 6.0 or later
- Visual Studio 2022 or later

### Installation

To use the Avro Source Generator in your project, add a reference to the `AvroSourceGenerator` package in your `.csproj` file:
### Usage

1. Define your Avro schema as a constant string in a partial class or record.
```cs
using AvroSourceGenerator;

namespace YourNamespace;

[Avro]
public partial record class User
{
    public const string AvroSchema = """
        {
            "type": "record",
            "namespace": "YourNamespace",
            "name": "User",
            "fields": [
                {
                    "name": "Name",
                    "type": "string"
                },
                {
                    "name": "Age",
                    "type": "int",
                    "default": 18
                },
                {
                    "name": "Description",
                    "type": [
                        "string",
                        "null"
                    ]
                }
            ]
        }
        """;
}
```
2. Build your project. The source generator will automatically generate the corresponding C# class based on the Avro schema.

### Example

Here is an example of a generated class for the `User` schema defined above:
```cs
```cs
// <auto-generated/>
#pragma warning disable
#nullable enable

namespace YourNamespace;

[global::System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute]
[global::System.CodeDom.Compiler.GeneratedCodeAttribute("AvroSourceGenerator", "1.0.0.0")]
public partial record class User : global::Avro.Specific.ISpecificRecord
{
    public static readonly global::Avro.Schema _SCHEMA = global::Avro.Schema.Parse(AvroSchema);
    public global::Avro.Schema Schema { get => User._SCHEMA; }
    public required string Name { get; init; }
    public required int Age { get; init; } = 18;
    public string? Description { get; init; }
    public object? Get(int fieldPos)
    {
        switch (fieldPos)
        {
            case 0: return this.Name;
            case 1: return this.Age;
            case 2: return this.Description;
            default: throw new global::Avro.AvroRuntimeException($"Bad index {fieldPos} in Get()");
        }
    }
    public void Put(int fieldPos, object? fieldValue)
    {
        switch (fieldPos)
        {
            case 0: Set_Name(this, (string)fieldValue!); break;
            case 1: Set_Age(this, (int)fieldValue!); break;
            case 2: Set_Description(this, (string?)fieldValue!); break;
            default: throw new global::Avro.AvroRuntimeException($"Bad index {fieldPos} in Put()");
        }
        [global::System.Runtime.CompilerServices.UnsafeAccessor(global::System.Runtime.CompilerServices.UnsafeAccessorKind.Method, Name = "set_Name")]
        extern static void Set_Name(User obj, string value);
        [global::System.Runtime.CompilerServices.UnsafeAccessor(global::System.Runtime.CompilerServices.UnsafeAccessorKind.Method, Name = "set_Age")]
        extern static void Set_Age(User obj, int value);
        [global::System.Runtime.CompilerServices.UnsafeAccessor(global::System.Runtime.CompilerServices.UnsafeAccessorKind.Method, Name = "set_Description")]
        extern static void Set_Description(User obj, string? value);
    }
}

#nullable restore
#pragma warning restore
```

## Contributing

Contributions are welcome! If you have any ideas, suggestions, or bug reports, please open an issue or submit a pull request.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Acknowledgements

- [Apache Avro](https://avro.apache.org/)
- [Roslyn](https://github.com/dotnet/roslyn)
